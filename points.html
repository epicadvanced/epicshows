<!DOCTYPE HTML>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyB62qoHWdEnchYSXU7vy3yy-BDwGtiUzuQ",
	authDomain: "epicadvanced19.firebaseapp.com",
	databaseURL: "https://epicadvanced19.firebaseio.com",
	projectId: "epicadvanced19",
	storageBucket: "epicadvanced19.appspot.com",
	messagingSenderId: "295442314130"
	};
      firebase.initializeApp(config);
      var database = firebase.database();
    </script>
  </head>
  <body>
    <h1>Points!</h1>
    <img id="meme" align="right" width="700" height="300" src="/images/getPoints.png">
    <h2>what are points</h2>
	  <p>you need them or you will fail drama.<br> the more you have, the less erik hates you.<br> do work please.</p>
    <h2>add points</h2>
      <form id="addPoints">
	    Name: 
	    <input type="text" id="addName"></input><br>
	    Points: 
	    <input type="text" id="addPoint"></input><br>
	    <input type="submit"></input><br>
      </form>
    <h2>find my points</h2>
      <form id="getPoints">
	    Name: 
	    <input type="text" id="myName"></input><br>
	    <input type="submit"></input><br>
      </form>
      <div id="myPoints"></div>
      <br>
    <h2>see current points</h2>
    <script>
	   //Get Points
	    function getPoint(uName) {
	    	firebase.database().ref('points/' + uName).once('value').then(function(snapshot) {
		    	var pointsVal = snapshot.val();
		    	var para = $("<p></p>").text(uName + ": " + pointsVal + " points");
		    	$("#myPoints").append(para);
	    	}); 
	    }
	    
	    $("#getPoints").submit(function(event) {
	      	  event.preventDefault();
		  getPoint($("#myName").val());
		  $("#myName").val("");
	      });
	    
	    //Get ALL Points
	    firebase.database().ref('points').once('value', function(snapshot) {
		snapshot.forEach(function(child) {
			var nameVal = child.key;
			var pointsVal = child.val();
			var paraName = $("<p></p>").text("Name: " + nameVal);
		   	var paraPoints = $("<p></p>").text("Points: " + pointsVal);
		   	$("body").append(paraName, paraPoints, "<br>");
		});
	    });
	    
	    //Add Points
	    function setPoints(name, pointsVal) {
		firebase.database().ref('/points/' + name).set(parseInt(pointsVal, 10));
	    }
	    
	    $("#addPoints").submit(function(event) {
		event.preventDefault(); 
		var addName = $("#addName").val();
		var addPoints = $("#addPoint").val();
		setPoints(addName, addPoints);
		$("#addName").val("");
		$("#addPoint").val("");
		location.reload();
	    });
    </script>
  </body>
</html>
