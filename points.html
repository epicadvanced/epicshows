<!DOCTYPE HTML>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyB62qoHWdEnchYSXU7vy3yy-BDwGtiUzuQ",
	authDomain: "epicadvanced19.firebaseapp.com",
	databaseURL: "https://epicadvanced19.firebaseio.com",
	projectId: "epicadvanced19",
	storageBucket: "epicadvanced19.appspot.com",
	messagingSenderId: "295442314130"
	};
      firebase.initializeApp(config);
      var database = firebase.database();
    </script>
    <style>
      html {
        height: 100%;
      }
      body {
	background: linear-gradient(to bottom right, #82d4f2, #f2a4b9);
	background-position: center;
        background-size: cover;
        box-sizing: border-box;
      }
      #backArrow {
	width: 30px;
	height: 30px;
        top-margin: 20px;
	display: inline;
        position: absolute;
	left: 10px;
	top: 10px;
      }
      #pointsTitle {
        letter-spacing: 8px; 
        border-bottom-color: rgb(255, 255, 255);
        border-bottom-style: solid;
        border-bottom-width: 1px;
        padding-top: 20px;
        padding-bottom: 15px;
	width: 300px;
	margin: auto;
      }
      h1, h2, p, form {
	font-family: "Source Sans Pro", sans-serif;
	color: white;
      }
      h1, h2 {
	text-shadow: 2px 2px #dbdbdb;	      
      }
      .palm {
	position: absolute;
	width: 250px;
	height: 400px;
	display: inline;
	top: 30%;
      }
      #leftPalm {
        left: 10px;	     
      }
      #rightPalm {
        right: 10px;	      
	-moz-transform: scaleX(-1);
        -o-transform: scaleX(-1);
        -webkit-transform: scaleX(-1);
        transform: scaleX(-1);
        filter: FlipH;
        -ms-filter: "FlipH";
      }
      .autoComplete {
	position: relative;
	display: inline-block;
      }
      .autocomplete-items {
        position: absolute;
        border: 1px solid #d4d4d4;
        border-bottom: none;
        border-top: none;
        z-index: 99;
     /*position the autocomplete items to be the same width as the container:*/
        top: 100%;
        left: 0;
        right: 0;
      }
      .autocomplete-items div {
        padding: 10px;
        cursor: pointer;
        background-color: #fff; 
        border-bottom: 1px solid #d4d4d4; 
      }
      .autocomplete-items div:hover {
        /*when hovering an item:*/
        background-color: #e9e9e9; 
      }
      .autocomplete-active {
        /*when navigating through the items using the arrow keys:*/
        background-color: DodgerBlue !important; 
        color: #ffffff; 
      }
    </style>
  </head>
  <body align=center>
    <a href="index.html" align=left><img id="backArrow" src="/images/left-arrow.png"></a>
	  <img id="pointsTitle" src="/images/pointsTitle.png">
    <h2>what are points</h2>
	  <p>advanced drama students need to acquire a certain number of points<br>
	     before the end of the semester in order to get a good grade. these <br>
             points are acquired by putting in time to help the company at work <br>
	     calls, shows, etc. people who earn lots of points will also recieve <br>
	     special prizes and be recognized in class
	  </p>
    <img class="palm" id="leftPalm" src="/images/vaporPalms.png">
    <img class="palm" id="rightPalm" src="/images/vaporPalms.png">
    <h2>add points</h2>
	  <a href="addPoints.html">Link</a>
    <h2>find my points</h2>
      <form autocomplete="off" id="getPoints">
	    Name: 
	    <div id="autoComplete" style="width:100px;">
	       <input type="text" class="myName" id="subName"></input>
	    </div>
	    <input type="submit"></input><br>
      </form>
      <div id="myPoints"></div>
      <br>
    <h2>leaderboard</h2>
    <span id="leaderboard"></span>
    <script>
	   var nameArray = []; 
	    
	   //Get Points
	    function getPoint(uName) {
	    	firebase.database().ref('points/' + uName.toLowerCase()).once('value').then(function(snapshot) {
		    	var pointsVal = snapshot.val();
		    	var para = $("<p></p>").text(uName + ": " + pointsVal + " points");
		    	$("#myPoints").append(para);
	    	}); 
	    }
	    
	    $("#getPoints").submit(function(event) {
	      	  event.preventDefault();
		  getPoint($("#myName").val());
		  $("#myName").val("");
	      });
	    
	    //Get ALL Points
	    firebase.database().ref('points').orderByValue().on('value', function(snapshot) {
		snapshot.forEach(function(child) {
			var nameVal = child.key;
			nameArray.push(nameVal);
			var pointsVal = child.val();
			var paraName = $("<p></p>").text("Name: " + nameVal);
		   	var paraPoints = $("<p></p>").text("Points: " + pointsVal);
		   	$("#leaderboard").prepend(paraName, paraPoints, "<br>");
		});    
	    });
	    
	    //what the fuck autocomplete
	    function autocomplete(inp, arr) {
  /*the autocomplete function takes two arguments,
  the text field element and an array of possible autocompleted values:*/
  var currentFocus;
  /*execute a function when someone writes in the text field:*/
  inp.addEventListener("input", function(e) {
      var a, b, i, val = this.value;
      /*close any already open lists of autocompleted values*/
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      /*create a DIV element that will contain the items (values):*/
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
      /*append the DIV element as a child of the autocomplete container:*/
      this.parentNode.appendChild(a);
      /*for each item in the array...*/
      for (i = 0; i < arr.length; i++) {
        /*check if the item starts with the same letters as the text field value:*/
        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          /*create a DIV element for each matching element:*/
          b = document.createElement("DIV");
          /*make the matching letters bold:*/
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
          /*insert a input field that will hold the current array item's value:*/
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
          /*execute a function when someone clicks on the item value (DIV element):*/
              b.addEventListener("click", function(e) {
              /*insert the value for the autocomplete text field:*/
              inp.value = this.getElementsByTagName("input")[0].value;
              /*close the list of autocompleted values,
              (or any other open lists of autocompleted values:*/
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });
  /*execute a function presses a key on the keyboard:*/
  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
      }
  });
  function addActive(x) {
    /*a function to classify an item as "active":*/
    if (!x) return false;
    /*start by removing the "active" class on all items:*/
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    /*add class "autocomplete-active":*/
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
    /*a function to remove the "active" class from all autocomplete items:*/
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
    /*close all autocomplete lists in the document,
    except the one passed as an argument:*/
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
      x[i].parentNode.removeChild(x[i]);
    }
  }
}
/*execute a function when someone clicks in the document:*/
document.addEventListener("click", function (e) {
    closeAllLists(e.target);
});
}
    autocomplete($("#subName"), nameArray);
    </script>
  </body>
</html>
